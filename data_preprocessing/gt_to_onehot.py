import numpy as np
import os

CenFreq = [0.0        ,   31.45090538,   31.90836934,   32.37248726,
         32.84335593,   33.32107354,   33.80573971,   34.29745552,
         34.7963235 ,   35.30244768,   35.8159336 ,   36.33688835,
         36.86542057,   37.40164045,   37.94565984,   38.49759217,
         39.05755255,   39.62565773,   40.20202619,   40.78677813,
         41.38003548,   41.98192196,   42.59256307,   43.21208617,
         43.84062043,   44.47829694,   45.12524867,   45.78161052,
         46.44751938,   47.12311411,   47.80853559,   48.50392675,
         49.20943261,   49.92520029,   50.65137905,   51.38812032,
         52.13557775,   52.89390719,   53.66326678,   54.44381697,
         55.23572052,   56.03914258,   56.85425068,   57.6812148 ,
         58.52020739,   59.3714034 ,   60.23498035,   61.11111832,
         62.        ,   62.90181077,   63.81673867,   64.74497451,
         65.68671185,   66.64214708,   67.61147943,   68.59491104,
         69.592647  ,   70.60489535,   71.63186721,   72.67377671,
         73.73084113,   74.80328091,   75.89131968,   76.99518435,
         78.11510509,   79.25131546,   80.40405239,   81.57355626,
         82.76007096,   83.96384391,   85.18512614,   86.42417233,
         87.68124087,   88.95659388,   90.25049734,   91.56322105,
         92.89503877,   94.24622822,   95.61707118,   97.0078535 ,
         98.41886522,   99.85040058,  101.3027581 ,  102.77624065,
        104.27115549,  105.78781437,  107.32653356,  108.88763394,
        110.47144105,  112.07828516,  113.70850136,  115.36242959,
        117.04041477,  118.74280681,  120.4699607 ,  122.22223663,
        124.        ,  125.80362153,  127.63347734,  129.48994902,
        131.3734237 ,  133.28429415,  135.22295885,  137.18982208,
        139.18529399,  141.20979071,  143.26373441,  145.34755341,
        147.46168226,  149.60656182,  151.78263937,  153.9903687 ,
        156.23021019,  158.50263092,  160.80810478,  163.14711252,
        165.52014192,  167.92768782,  170.37025228,  172.84834467,
        175.36248173,  177.91318777,  180.50099467,  183.1264421 ,
        185.79007753,  188.49245644,  191.23414235,  194.015707  ,
        196.83773044,  199.70080116,  202.6055162 ,  205.5524813 ,
        208.54231098,  211.57562874,  214.65306713,  217.77526789,
        220.9428821 ,  224.15657032,  227.41700271,  230.72485919,
        234.08082955,  237.48561361,  240.93992141,  244.44447326,
        248.        ,  251.60724306,  255.26695469,  258.97989804,
        262.7468474 ,  266.5685883 ,  270.4459177 ,  274.37964416,
        278.37058798,  282.41958142,  286.52746882,  290.69510683,
        294.92336452,  299.21312364,  303.56527874,  307.98073739,
        312.46042037,  317.00526184,  321.61620955,  326.29422504,
        331.04028383,  335.85537564,  340.74050457,  345.69668934,
        350.72496347,  355.82637553,  361.00198934,  366.25288419,
        371.58015507,  376.98491288,  382.4682847 ,  388.03141401,
        393.67546089,  399.40160232,  405.2110324 ,  411.10496259,
        417.08462197,  423.15125749,  429.30613426,  435.55053577,
        441.8857642 ,  448.31314064,  454.83400543,  461.44971838,
        468.16165909,  474.97122723,  481.87984281,  488.88894653,
        496.        ,  503.21448613,  510.53390938,  517.95979608,
        525.4936948 ,  533.1371766 ,  540.8918354 ,  548.75928831,
        556.74117596,  564.83916284,  573.05493765,  581.39021365,
        589.84672904,  598.42624728,  607.13055748,  615.96147479,
        624.92084075,  634.01052369,  643.23241911,  652.58845009,
        662.08056767,  671.71075128,  681.48100914,  691.39337867,
        701.44992694,  711.65275107,  722.00397869,  732.50576839,
        743.16031013,  753.96982575,  764.9365694 ,  776.06282801,
        787.35092178,  798.80320465,  810.42206481,  822.20992518,
        834.16924393,  846.30251498,  858.61226852,  871.10107155,
        883.7715284 ,  896.62628128,  909.66801086,  922.89943676,
        936.32331818,  949.94245445,  963.75968562,  977.77789305,
        992.        , 1006.42897226, 1021.06781875, 1035.91959217,
       1050.9873896 , 1066.2743532 , 1081.7836708 , 1097.51857663,
       1113.48235192, 1129.67832568, 1146.1098753 , 1162.78042731,
       1179.69345808, 1196.85249455, 1214.26111496, 1231.92294958,
       1249.8416815 ]



result_dir = "./train_RESULT/"

label_dir = './train_LABEL/'

npz_dir = './train_NPZ/'

list1 = os.listdir(npz_dir) 
wav_list=[]
for name in list1:

	wav_list.append(name.split('.')[0])
print(wav_list)



c_name_list = wav_list

count = 0
for namelist in c_name_list:
	print(namelist)
	f1 = open(result_dir+namelist+"REF.txt",'r')
	hz_list = []
	min1_list = []
	for line in f1:

		hz_list.append(line.split('\t')[1])
		list1 = []
		for idx,cenFreq in enumerate(CenFreq):

			list1.append(abs(cenFreq - eval(line.split('\t')[1])))
		min1 = np.argmin(list1)

		min1_list.append(min1)

	A = np.load(npz_dir + namelist + ".npz")
	data = A['data']
	time_arr = A['time_arr']


	if len(time_arr) > len(min1_list):

		zero_np = np.zeros(len(time_arr) - len(min1_list))
		zero_np = zero_np.astype(np.int)
		zero_list = zero_np.tolist()

		min1_list.extend(zero_list)

	else:

		min1_list = min1_list[0:len(time_arr)]

	f2 = open(result_dir+namelist+"REF_label.txt",'w')
	f2.write(str(min1_list))
	f2.close()
	print(len(min1_list))


	
